<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <%- include("partials/head.ejs") %>
  <link rel="stylesheet" href="/css/post.css">
  <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
  <title><%= post.title %></title>
</head>
<body>
  <%- include("partials/header.ejs") %>
  
  <main class="container">
    <div class="post-card">
      <img src="/images/bg-masthead.jpg" class="card-img-top" alt="Post background">
      
      <div class="post-overlay">
        <!-- Post Header -->
        <div class="post-header">
          <span class="post-subject"><%= post.subject %></span>
          <h1 class="post-title"><%= post.title %></h1>
        </div>

        <!-- Post Content -->
        <div class="post-content-section">
          <div class="post-content-box scrollable-content">
            <p class="post-content"><%= post.content %></p>
          </div>
        </div>

        <!-- Post Metadata -->
        <div class="post-meta-section">
          <div class="meta-row">
            <div class="meta-item">
              <i class="fas fa-calendar-plus"></i>
              <span class="meta-label">Created:</span>
              <span class="meta-value">
                <% try { %>
                  <%= new Date(post.createdAt).toLocaleString('en-US', {
                    month: 'short', day: 'numeric', year: 'numeric',
                    hour: '2-digit', minute: '2-digit', hour12: false
                  }); %>
                <% } catch (error) { %>
                  <span class="text-muted">Invalid date</span>
                <% } %>
              </span>
            </div>

            <% if (post.updatedAt && post.updatedAt !== post.createdAt) { %>
            <div class="meta-item">
              <i class="fas fa-edit"></i>
              <span class="meta-label">Last Modified:</span>
              <span class="meta-value">
                <% try { %>
                  <%= new Date(post.updatedAt).toLocaleString('en-US', {
                    month: 'short', day: 'numeric', year: 'numeric',
                    hour: '2-digit', minute: '2-digit', hour12: false
                  }); %>
                <% } catch (error) { %>
                  <span class="text-muted">Invalid date</span>
                <% } %>
              </span>
            </div>
            <% } %>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="post-actions">
          <a class="btn btn-primary" href="/edit/<%= post.id %>">
            <i class="fas fa-edit"></i> Edit this Post
          </a>
          <a class="btn btn-secondary" href="/">
            <i class="fas fa-home"></i> Back Home
          </a>
        </div>
      </div>
    </div>
  </main>

  <%- include("partials/footer.ejs") %>
  
  <script src="/js/theme-toggle.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>